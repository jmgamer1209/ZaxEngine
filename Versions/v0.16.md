## C#脚本接入

这个版本本来要实现一个简易的资源管理，但是由于资源管理需要序列化，而C++没有原生反射，正好后面想要接入C#脚本，所以，计划先接入C#脚本，再继续资源管理的设计


### 第1步，接入 Mono 运行时

注意2个问题：
1. 最新的 Mono 版本已经合并到 .NET 仓库中，所以，需要去 NET 仓库获取
2. 默认的垃圾回收是 sgen，这会导致在垃圾回收时，对象的地址会改变，同时也会导致引擎的卡帧，所以，这里需要通过修改编译参数，使用贝姆垃圾回收

### 第2步，实现C#脚本接入设计

这里先后浏览了 Overload 和 Unity 的脚本设计，原来C#只是一个接口层，所有的属性和函数，都是通过 Internal Call（等同于 DLLImport）直接调用C++层。

那么，设计上分为3层：
1. 引擎C#层，核心函数都是 Internal Call
2. 引擎C++绑定层，用于连接C#层和C++层
3. 引擎C++核心层

在玩家层面，在 GameStart 函数中，依次创建纹理，物体对象，场景，组件

为了解决Gameplay层自定义组件的情况，单独在引擎的C#层增加了 GameComponent 类，这样引擎层可以通过判断该类，区分是引擎的C#层，还是开发者的Gameplay层。


**运行结果：**
![](../Versions/Assets/v0.16_result.png)